<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Cyberbar — Barman Interativo</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #05040a;
        --neon-pink: #f72585;
        --neon-blue: #00d0ff;
        --glass: rgba(0, 0, 0, 0.55);
        --text: #e8eef8;
        --accent: rgba(247, 37, 133, 0.12);
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
        margin: 0;
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto,
          "Helvetica Neue", Arial;
        background: var(--bg);
        color: var(--text);
      }

      /* Stage & background */
      .stage {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .bg {
        position: absolute;
        inset: 0;
        background-image: url("./background_bar.png");
        background-size: cover;
        background-position: center;
        filter: brightness(0.6) contrast(1.02);
        transform: scale(1.02);
      }
      /* soft gradient tint to match neon lighting */
      .bg::after {
        content: "";
        position: absolute;
        inset: 0;
        pointer-events: none;
        background: linear-gradient(
          120deg,
          rgba(8, 6, 18, 0.6) 10%,
          rgba(247, 37, 133, 0.06) 35%,
          rgba(0, 208, 255, 0.02) 70%
        );
      }

      /* container that holds ui and character */
      .scene {
        position: relative;
        z-index: 2;
        width: min(1200px, 96%);
        height: min(750px, 94%);
        display: grid;
        grid-template-columns: 420px 1fr;
        gap: 24px;
        align-items: end;
      }

      /* Character panel */
      .char-wrap {
        position: relative;
        display: flex;
        align-items: flex-end;
        justify-content: center;
        padding: 12px;
      }
      .char {
        width: 360px;
        max-width: 80%;
        border-radius: 18px;
        overflow: visible;
        position: relative;
        cursor: pointer;
        transition: transform 0.28s, filter 0.28s ease;
      }
      .char img {
        display: block;
        width: 280%;
        height: auto;
        filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.6));
        border-radius: 12px;
      }
      /* neon rim */
      .char::before {
        content: "";
        position: absolute;
        left: -6px;
        right: -6px;
        top: -6px;
        bottom: -6px;
        border-radius: 20px;
        pointer-events: none;
        transition: box-shadow 0.25s ease, opacity 0.25s ease;
        opacity: 0;
      }
      .char:hover {
        transform: scale(1.02);
      }
      .char:hover::before {
        opacity: 1;
        box-shadow: 0 0 28px 6px rgba(247, 37, 133, 0.12),
          inset 0 1px 0 rgba(255, 255, 255, 0.02);
      }

      /* subtle tilt following mouse */
      .char[data-tilt] {
        transform-origin: center center;
      }

      /* Info tag (name & small subtitle) */
      .nameplate {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        bottom: -14px;
        background: linear-gradient(
          180deg,
          rgba(0, 0, 0, 0.55),
          rgba(0, 0, 0, 0.45)
        );
        padding: 8px 14px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        font-weight: 600;
        font-family: Orbitron, Inter;
        letter-spacing: 0.6px;
        color: var(--text);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.6);
      }

      /* HUD / dialog */
      .ui {
        position: relative;
        display: flex;
        flex-direction: column;
        gap: 12px;
        padding: 18px;
      }
      .prompt {
        background: linear-gradient(
          180deg,
          rgba(0, 0, 0, 0.72),
          rgba(0, 0, 0, 0.6)
        );
        border-radius: 12px;
        padding: 14px;
        border: 1px solid rgba(255, 255, 255, 0.04);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(6px);
      }
      .header {
        font-family: Orbitron, Inter;
        font-weight: 700;
        color: var(--neon-pink);
        font-size: 18px;
        padding: 6px 10px;
        border-radius: 8px;
        border: 1px solid rgba(247, 37, 133, 0.08);
        display: inline-block;
      }
      .dialog-box {
        margin-top: 8px;
        min-height: 82px;
        color: var(--text);
        font-size: 15px;
        line-height: 1.45;
      }

      /* choices grid similar to image 1 */
      .choices {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        margin-top: 10px;
      }
      .choice {
        background: linear-gradient(
          180deg,
          rgba(0, 0, 0, 0.6),
          rgba(0, 0, 0, 0.48)
        );
        border-radius: 10px;
        padding: 12px 16px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.18s ease, box-shadow 0.18s ease;
      }
      .choice:hover {
        transform: translateY(-4px);
        box-shadow: 0 14px 30px rgba(0, 0, 0, 0.55),
          0 0 26px rgba(0, 208, 255, 0.06);
      }
      .choice .sub {
        display: block;
        font-weight: 400;
        font-size: 13px;
        color: #bfc9d9;
        margin-top: 6px;
      }

      /* lower function bar for quick tips */
      .footer {
        margin-top: 6px;
        font-size: 13px;
        color: rgba(255, 255, 255, 0.65);
      }

      /* small responsive adjustments */
      @media (max-width: 900px) {
        .scene {
          grid-template-columns: 1fr;
          align-items: end;
        }
        .char {
          width: 44vw;
        }
        .nameplate {
          bottom: -18px;
        }
      }
      @media (max-width: 520px) {
        .char {
          width: 56vw;
        }
        .choices {
          grid-template-columns: 1fr;
        }
        .dialog-box {
          font-size: 14px;
        }
        .header {
          font-size: 16px;
        }
      }
    </style>
  </head>
  <body>
    <div
      class="stage"
      role="application"
      aria-label="Cyberbar - Interação com Barman"
    >
      <div class="bg" aria-hidden="true"></div>

      <div class="scene">
        <!-- character column -->
        <div class="char-wrap">
          <div
            class="char"
            id="barman"
            role="button"
            aria-pressed="false"
            tabindex="0"
          >
            <img src="./personagem.png" alt="Dorian - barman" id="barmanImg" />
            <div class="nameplate">Dorian — Barman</div>
          </div>
        </div>

        <!-- UI column -->
        <div class="ui">
          <div class="prompt">
            <div class="header">Clique no barman.</div>
            <div class="dialog-box" id="dialog">
              Clique no barman ou escolha uma opção abaixo. Dorian limpa o copo
              enquanto observa a cidade de neon pela janela.
            </div>

            <div class="choices" id="choices">
              <button class="choice" data-action="falar">
                <strong>Falar</strong><span class="sub">Começar conversa</span>
              </button>
              <button class="choice" data-action="observar">
                <strong>Observar</strong
                ><span class="sub">Olhar suas ações</span>
              </button>
              <button class="choice" data-action="bebida">
                <strong>Pedir bebida</strong
                ><span class="sub">Pedir uma bebida especial</span>
              </button>
              <button class="choice" data-action="secreta">
                <strong>Ação secreta</strong
                ><span class="sub">Tentar algo incomum</span>
              </button>
            </div>

            <div class="footer">
              Dica: você também pode clicar diretamente no personagem para
              respostas únicas. Use as setas / Enter para navegar.
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Dados de diálogo em formato de nó (para fluxo similar a jogo HTML)
      const nodes = {
        start: {
          text: [
            "Dorian (baixinho): Você não parece daqui. O que procura na noite neon?",
            "Dorian: Segredos, trabalho ou apenas uma bebida forte?",
          ],
          options: ["falar", "observar", "bebida", "secreta"],
        },
        falar: {
          text: [
            "Dorian: Conte-me algo. Cidade grande demais para manter segredos... normalmente.",
            "Dorian (curioso): Tem alguém te seguindo?",
          ],
          options: [
            { label: "Procurando trabalho", goto: "job" },
            { label: "Só passeando", goto: "tour" },
            { label: "Nada a declarar", goto: "silent" },
          ],
        },
        observar: {
          text: [
            "Ele limpa o copo com calma. Sob o terno impecável, parece um homem de ação.",
            "Seus olhos varrem o bar como um scanner. Nada escapa.",
          ],
          options: [
            { label: "Perguntar sobre olhar", goto: "look" },
            { label: "Ficar quieto", goto: "silent" },
          ],
        },
        bebida: {
          text: [
            'Dorian: "Neon Velvet" ou "Chuva Ácida"? Eu tenho ambos.',
            "Ele sorri: Algo forte para esquecer ou algo suave para lembrar?",
          ],
          options: [
            { label: "Neon Velvet", goto: "neon" },
            { label: "Chuva Ácida", goto: "acid" },
            { label: "Deixe pra lá", goto: "silent" },
          ],
        },
        secreta: {
          text: [
            "Dorian: Ah, a ação secreta... Nem todo mundo pede por isso. Tem coragem?",
            "Dorian (sussurro): Posso te conectar a um contato — a conta é alta.",
          ],
          options: [
            { label: "Pedir contato", goto: "contact" },
            { label: "Voltar", goto: "start" },
          ],
        },
        click: {
          text: [
            "Dorian (olhar atento): Segredos ou trabalho? O tom dele é quase uma oferta.",
            "Dorian (baixinho): Eu já vi gente cujo sorriso escondia mais do que devia.",
          ],
          options: [
            { label: "Falar", goto: "falar" },
            { label: "Observar", goto: "observar" },
          ],
        },
        job: {
          text: [
            "Dorian: Posso te indicar um job discreto. Primeiro, deixa eu ver suas habilidades.",
          ],
          options: [
            { label: "Mostrar habilidades", goto: "skills" },
            { label: "Recusar", goto: "start" },
          ],
        },
        tour: {
          text: [
            "Dorian: A cidade devora os desavisados. Fique perto da luz, não do escuro.",
          ],
          options: [{ label: "Obrigado", goto: "start" }],
        },
        silent: {
          text: ["Dorian: Silêncio é uma resposta. Às vezes a melhor."],
          options: [{ label: "Voltar", goto: "start" }],
        },
        look: {
          text: [
            "Dorian: Há câmeras, drones e olhos maiores que os seus. Se soubesse, ajudaria?",
          ],
          options: [
            { label: "Sim", goto: "helpCam" },
            { label: "Não", goto: "start" },
          ],
        },
        neon: {
          text: [
            'Você recebe um "Neon Velvet" — um coquetel aveludado com um toque cítrico. Ele entrega com um olhar sagaz.',
          ],
          options: [
            { label: "Agradecer", goto: "start" },
            { label: "Perguntar segredo", goto: "secreta" },
          ],
        },
        acid: {
          text: [
            'Você recebe uma "Chuva Ácida" — intenso, ardente, direto ao ponto. Dorian: Isso abre portas... e rancores.',
          ],
          options: [
            { label: "Pagar", goto: "start" },
            { label: "Voltar", goto: "start" },
          ],
        },
        contact: {
          text: [
            "Dorian: Me dê uma semana; farei a ligação. Mas lembrando — não trabalho de graça.",
          ],
          options: [
            { label: "Aceitar os termos", goto: "start" },
            { label: "Cancelar", goto: "start" },
          ],
        },
        skills: {
          text: [
            "Você mostra suas habilidades. Dorian sorri com interesse: Talvez eu tenha algo.",
          ],
          options: [{ label: "Saber mais", goto: "start" }],
        },
        helpCam: {
          text: [
            "Dorian explica rotas e rotinas de patrulha local. Informações úteis para quem quer evitar atenção.",
          ],
          options: [{ label: "Anotar", goto: "start" }],
        },
      };

      // utilidades
      const dialogEl = document.getElementById("dialog");
      const choicesEl = document.getElementById("choices");
      const barmanEl = document.getElementById("barman");
      const barmanImg = document.getElementById("barmanImg");

      // typewriter effect (ritmo configurável)
      let typingTimer = null;
      function typeText(text, target, speed = 18) {
        cancelType();
        target.textContent = "";
        let i = 0;
        typingTimer = setInterval(() => {
          target.textContent += text.charAt(i) || "";
          i++;
          if (i > text.length) {
            cancelType();
          }
        }, speed);
      }
      function cancelType() {
        if (typingTimer) {
          clearInterval(typingTimer);
          typingTimer = null;
        }
      }

      // pick random from array helper
      function pick(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
      }

      // render node
      function showNode(nodeId) {
        const node = typeof nodeId === "string" ? nodes[nodeId] : nodeId;
        if (!node) return;
        // choose a random text from node.text array
        const text = Array.isArray(node.text) ? pick(node.text) : node.text;
        typeText(text, dialogEl);

        // render options
        // clear old choices
        choicesEl.innerHTML = "";
        if (node.options && node.options.length) {
          node.options.forEach((opt) => {
            const btn = document.createElement("button");
            btn.className = "choice";
            if (typeof opt === "string") {
              // predefined quick actions e.g. 'falar'
              btn.dataset.action = opt;
              btn.innerHTML = `<strong>${capitalize(
                opt
              )}</strong><span class="sub">Clique para ${opt}</span>`;
              btn.addEventListener("click", () => interact(opt));
            } else {
              btn.textContent = opt.label;
              btn.addEventListener("click", () => showNode(opt.goto));
            }
            choicesEl.appendChild(btn);
          });
        }
      }

      function capitalize(s) {
        return s.charAt(0).toUpperCase() + s.slice(1);
      }

      // main interact function that routes shortcuts
      function interact(action) {
        if (!action) return;
        switch (action) {
          case "falar":
            showNode("falar");
            break;
          case "observar":
            showNode("observar");
            break;
          case "bebida":
            showNode("bebida");
            break;
          case "secreta":
            showNode("secreta");
            break;
          case "click":
            showNode("click");
            break;
          default:
            showNode("start");
        }
      }

      // barman click
      barmanEl.addEventListener("click", () => {
        interact("click");
        barmanEl.setAttribute("aria-pressed", "true");
        setTimeout(() => barmanEl.setAttribute("aria-pressed", "false"), 600);
      });
      // keyboard accessibility
      barmanEl.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          barmanEl.click();
        }
      });

      // initial node
      showNode("start");

      // tilt effect following the mouse on character to look more interactive
      barmanEl.addEventListener("mousemove", (e) => {
        const rect = barmanEl.getBoundingClientRect();
        const cx = rect.left + rect.width / 2;
        const cy = rect.top + rect.height / 2;
        const dx = (e.clientX - cx) / rect.width;
        const dy = (e.clientY - cy) / rect.height;
        const rx = dy * 6;
        const ry = -dx * 8;
        barmanEl.style.transform = `perspective(600px) rotateX(${rx}deg) rotateY(${ry}deg) translateZ(4px)`;
        barmanEl.setAttribute("data-tilt", "true");
      });
      barmanEl.addEventListener("mouseleave", () => {
        barmanEl.style.transform = "";
        barmanEl.removeAttribute("data-tilt");
      });

      // keyboard navigation for choices
      document.addEventListener("keydown", (e) => {
        const focusable = Array.from(document.querySelectorAll(".choice"));
        const active = document.activeElement;
        if (e.key === "ArrowDown" || e.key === "ArrowRight") {
          e.preventDefault();
          const idx = Math.max(0, focusable.indexOf(active));
          const next = focusable[(idx + 1) % focusable.length];
          if (next) next.focus();
        }
        if (e.key === "ArrowUp" || e.key === "ArrowLeft") {
          e.preventDefault();
          const idx = Math.max(0, focusable.indexOf(active));
          const prev =
            focusable[(idx - 1 + focusable.length) % focusable.length];
          if (prev) prev.focus();
        }
      });

      // small polish: hint animation for choices on first load
      window.addEventListener("load", () => {
        const first = document.querySelector(".choice");
        if (first) {
          first.animate(
            [{ transform: "translateY(6px)" }, { transform: "translateY(0)" }],
            { duration: 320, easing: "cubic-bezier(.3,.8,.2,1)" }
          );
        }
      });
    </script>
  </body>
</html>
